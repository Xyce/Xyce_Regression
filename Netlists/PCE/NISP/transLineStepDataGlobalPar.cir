* 3 stage RC Ladder.
*
* Generated by running RC_ladder.pl 3 <return>, where 3 is the number of parallel resistor-capacitor 
* with shunt capacitor subcircuits in series.
*
.global_param cap=1e-8
.global_param res=1k

Vs 1 0 sin (0.0 1.0  100k)
Rgs 1 2 0.02

.subckt RCBlock IN OUT GND
R1 IN OUT {res}
C1 IN OUT {cap}
Cg1 OUT GND 1e-9
.ends

X1 2 3 0 RCBlock
X2 3 4 0 RCBlock
X3 4 5 0 RCBlock

.print tran v(2) v(5)
.tran 10p 2e-5

.SENS objfunc={V(5)} param=cap
.options SENSITIVITY direct=1 adjoint=0  diagnosticfile=0  stdoutput=0 
.print sens v(2)

.SAMPLING 
+ param=res
+ type=uniform
+ lower_bounds=0.5K
+ upper_bounds=1.5K

.options SAMPLES numsamples=5
+ order=3
+ projection_pce=true

