# This file is generated by the script SetUpCtestFiles.py
# If possible, modify the script to fix any issues with the CMakeLists.txt files
# Or you can remove this header line to prevent this file from being overwritten

cmake_minimum_required(VERSION 3.22 FATAL_ERROR)
project(XyceRegression VERSION 7.11.0 LANGUAGES NONE)
message(DEBUG "[DBG]: CMAKE_CURRENT_SOURCE_DIR: ${CMAKE_CURRENT_SOURCE_DIR}")
set(XYCE_VERIFY "${CMAKE_CURRENT_SOURCE_DIR}/TestScripts/xyce_verify.pl")
message(DEBUG "[DBG]: XYCE_VERIFY: ${XYCE_VERIFY}")
set(OutputDataDir "${CMAKE_CURRENT_SOURCE_DIR}/OutputData")
set(TestNamePrefix "")
set(XyceRegressionTestScripts ${CMAKE_CURRENT_SOURCE_DIR}/TestScripts)
if(TARGET Xyce)
  get_target_property(XyceBuildDir Xyce BINARY_DIR)
  message(DEBUG "[DBG]: XyceBuildDir: ${XyceBuildDir}")
  cmake_path(SET XYCE_BINARY $<TARGET_FILE:Xyce>)
else()
  enable_testing()
  message(DEBUG "[DBG]: Target Xyce not inherited from parent project. Looking for Xyce on PATH and with environment variable Xyce_DIR")
  find_program(XYCE_BINARY NAMES Xyce Xyce.exe HINTS ENV XYCE_DIR ENV Xyce_DIR )
  message(DEBUG "[DBG]: XYCE_BINARY: ${XYCE_BINARY}")
  if( XYCE_BINARY STREQUAL "XYCE_BINARY-NOTFOUND")
    message(FATAL_ERROR "No Xyce binary found on path or set with environment variable Xyce_DIR")
  else()
    # Xyce is installed.  Use Xyce's capabilities option to set build options 
    execute_process(COMMAND ${XYCE_BINARY} -capabilities OUTPUT_VARIABLE XyceCapabilities ERROR_VARIABLE XyceErrorMsg)
    #message(DEBUG "Xyce capabilities are ${XyceCapabilities} and ${XyceErrorMsg}")
    set( Xyce_PARALLEL_MPI FALSE CACHE BOOL "True Xyce if built with MPI")
    set( Xyce_RAD_MODELS FALSE CACHE BOOL "Xyce rad models included")
    set( Xyce_NONFREE_MODELS FLASE CACHE BOOL "Non-free device models")
    set( Xyce_ADMS_MODELS FALSE CACHE BOOL "ADMS models")
    set( Xyce_ADMS_SENSITIVITIES FALSE CACHE BOOL "ADMS sensitivities")
    set( Xyce_USE_FFT FALSE CACHE BOOL "FFT enabled")
    set( Xyce_REACTION_PARSER FALSE CACHE BOOL "Reaction parser available")
    set( Xyce_ATHENA FALSE CACHE BOOL "ATHENA available")
    set( Xyce_ROL FALSE CACHE BOOL "ROL enabled")
    set( Xyce_STOKHOS_ENABLE FALSE CACHE BOOL "Stokhos enabled")
    set( Xyce_AMESOS2 FALSE CACHE BOOL "Amesos2 available")
    if( XyceCapabilities MATCHES "Parallel with MPI")
      set( Xyce_PARALLEL_MPI TRUE CACHE BOOL "True Xyce if built with MPI" FORCE )
    endif()
    if( XyceCapabilities MATCHES "Radiation models")
      set( Xyce_RAD_MODELS TRUE CACHE BOOL "Xyce rad models included" FORCE)
    endif()
    if( XyceCapabilities MATCHES "Non-Free device models")
      set( Xyce_NONFREE_MODELS TRUE CACHE BOOL "Non-free device models" FORCE)
    endif()
    if( XyceCapabilities MATCHES "Verilog-A derived")
      set( Xyce_ADMS_MODELS TRUE CACHE BOOL "ADMS models" FORCE)
    endif()
    if( XyceCapabilities MATCHES "Analytic sensitivities in ADMS models")
      set( Xyce_ADMS_SENSITIVITIES TRUE CACHE BOOL "ADMS sensitivities" FORCE)
    endif()
    if( XyceCapabilities MATCHES "FFT")
      set( Xyce_USE_FFT TRUE CACHE BOOL "FFT enabled" FORCE)
    endif()
    if( XyceCapabilities MATCHES "Reaction parser")
      set( Xyce_REACTION_PARSER TRUE CACHE BOOL "Reaction parser available" FORCE)
    endif()
    if( XyceCapabilities MATCHES "ATHENA")
      set( Xyce_ATHENA TRUE CACHE BOOL "ATHENA available" FORCE)
    endif()
    if( XyceCapabilities MATCHES "ROL enabled")
      set( Xyce_ROL TRUE CACHE BOOL "ROL enabled" FORCE)
    endif()
    if( XyceCapabilities MATCHES "Stokhos enabled")
      set( Xyce_STOKHOS_ENABLE TRUE  CACHE BOOL "Stokhos enabled" FORCE)
    endif()
    if( XyceCapabilities MATCHES "Amesos2")
      set( Xyce_AMESOS2 TRUE CACHE BOOL "Amesos2 available" FORCE)
    endif()
    message(DEBUG "[DBG]: Xyce_PARALLEL_MPI is ${Xyce_PARALLEL_MPI} ")
    message(DEBUG "[DBG]: Xyce_RAD_MODELS is ${Xyce_RAD_MODELS} ")
    message(DEBUG "[DBG]: Xyce_NONFREE_MODELS is ${Xyce_NONFREE_MODELS}")
    message(DEBUG "[DBG]: Xyce_ADMS_MODELS is ${Xyce_ADMS_MODELS} ")
    message(DEBUG "[DBG]: Xyce_ADMS_SENSITIVITIES is ${Xyce_ADMS_SENSITIVITIES} ")
    message(DEBUG "[DBG]: Xyce_USE_FFT is ${Xyce_USE_FFT} ")
    message(DEBUG "[DBG]: Xyce_REACTION_PARSER is ${Xyce_REACTION_PARSER} ")
    message(DEBUG "[DBG]: Xyce_ATHENA is ${Xyce_ATHENA} ")
    message(DEBUG "[DBG]: Xyce_ROL is ${Xyce_ROL} ")
    message(DEBUG "[DBG]: Xyce_STOKHOS_ENABLE is ${Xyce_STOKHOS_ENABLE} ")
    message(DEBUG "[DBG]: Xyce_AMESOS2 is ${Xyce_AMESOS2} ")
  endif()
endif()
set(DAKOTA_FOUND FALSE CACHE BOOL "True if dakota found.")
set(PERL_FOUND FALSE CACHE BOOL "True if perl found.")
set(BASH_FOUND FALSE CACHE BOOL "True if bash found.")
set(BASH_FOUND FALSE CACHE BOOL "True if bash found.")
set(BASH_FOUND FALSE CACHE BOOL "True if bash found.")
set(PYTHON_FOUND FALSE CACHE BOOL "True if python package found.")
set(SIMULINK_FOUND FALSE CACHE BOOL "True if simulink found.")
set(XDM_BDL_FOUND FALSE CACHE BOOL "True if xdm_bld found.")
set(ADMSXML_FOUND FALSE CACHE BOOL "True if admsXml found.")
set(MS_VPP_FOUND FALSE CACHE BOOL "True if vpp compiler found.")
set(VALGRIND_FOUND FALSE CACHE BOOL "True if valgrind found.")
set(VALGRIND_MASTER FALSE CACHE BOOL "True if valgrind_master set.")
find_program(PERL_BIN perl)
if( NOT (PERL_BIN STREQUAL "PERL_BIN-NOTFOUND"))
  set(PERL_FOUND "TRUE")
endif()
message(STATUS "Perl found ${PERL_FOUND}")
find_program(BASH_FOUND bash)
if( NOT (BASH_FOUND STREQUAL "BASH_FOUND-NOTFOUND"))
  set(BASH_FOUND "TRUE")
endif()
message(STATUS "Bash found ${BASH_FOUND}")
find_program(PYTHON_BIN python)
if( NOT (PYTHON_BIN STREQUAL "PYTHON_BIN-NOTFOUND"))
  set(PYTHON_FOUND "TRUE")
endif()
message(STATUS "Python found ${PYTHON_FOUND}")
if( PYTHON_FOUND )
  execute_process(COMMAND ${PYTHON_BIN} -c "import numpy" RESULT_VARIABLE CMD_SUCCESS ERROR_QUIET)
  if( CMD_SUCCESS EQUAL 0)
    set(PYTHON_NUMPY_FOUND "TRUE")
  endif()
  message(STATUS "Python package numpy found ${PYTHON_NUMPY_FOUND}")
  execute_process(COMMAND ${PYTHON_BIN} -c "import scipy" RESULT_VARIABLE CMD_SUCCESS ERROR_QUIET)
  if( CMD_SUCCESS EQUAL 0)
    set(PYTHON_SCIPY_FOUND "TRUE")
  endif()
  message(STATUS "Python package scipy found ${PYTHON_SCIPY_FOUND}")
  execute_process(COMMAND ${PYTHON_BIN} -c "import pytest" RESULT_VARIABLE CMD_SUCCESS ERROR_QUIET)
  if( CMD_SUCCESS EQUAL 0)
    set(PYTHON_PYTEST_FOUND "TRUE")
  endif()
  message(STATUS "Python package pytest found ${PYTHON_PYTEST_FOUND}")
endif()
find_program(XDM_BDL_BIN xdm_bdl)
if( NOT (XDM_BDL_BIN STREQUAL "XDM_BDL_BIN-NOTFOUND"))
  set(XDM_BDL_FOUND "TRUE")
endif()
message(STATUS "xdm_bdl found ${XDM_BDL_FOUND}")
find_program(ADMSXML_BIN admsXml)
if( NOT (ADMSXML_BIN STREQUAL "ADMSXML_BIN-NOTFOUND"))
  set(ADMSXML_FOUND "TRUE")
endif()
message(STATUS "admsXml found ${ADMSXML_FOUND}")
find_program(MS_VPP_BIN vpp)
if( NOT (MS_VPP_BIN STREQUAL "MS_VPP_BIN-NOTFOUND"))
  set(MS_VPP_FOUND "TRUE")
endif()
message(STATUS "vpp found ${MS_VPP_FOUND}")
# Sandia Tests
if (EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/../Xyce_SandiaRegression" AND EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/../Xyce_SandiaRegression/CMakeLists.txt" )
  message(STATUS "Adding Xyce_SandiaRegression tests")
  add_subdirectory( ${CMAKE_CURRENT_SOURCE_DIR}/../Xyce_SandiaRegression Xyce_SandiaRegression)
elseif (EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/Xyce_SandiaRegression" AND EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/Xyce_SandiaRegression/CMakeLists.txt" )
  message(STATUS "Adding Xyce_SandiaRegression tests")
  add_subdirectory( ${CMAKE_CURRENT_SOURCE_DIR}/Xyce_SandiaRegression Xyce_SandiaRegression)
else()
  message(WARNING "Xyce_SandiaRegression tests not found")
endif()
# Fastrack Tests
if (EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/../Xyce_FastrackRegression" AND EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/../Xyce_FastrackRegression/CMakeLists.txt" )
  message(STATUS "Adding Xyce_FasttrackRegression tests")
  add_subdirectory( ${CMAKE_CURRENT_SOURCE_DIR}/../Xyce_FastrackRegression Xyce_FastrackRegression)
elseif (EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/Xyce_FastrackRegression" AND EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/Xyce_FastrackRegression/CMakeLists.txt")
  message(STATUS "Adding Xyce_FastrackRegression tests")
  add_subdirectory( ${CMAKE_CURRENT_SOURCE_DIR}/Xyce_FastrackRegression Xyce_FastrackRegression)
else()
  message(WARNING "Xyce_FastrackRegression tests not found")
endif()
# General Tests
message(STATUS "Adding general tests")
add_subdirectory(Netlists)
